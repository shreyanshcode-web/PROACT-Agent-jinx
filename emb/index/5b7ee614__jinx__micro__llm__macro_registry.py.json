{"file_rel": "jinx\\micro\\llm\\macro_registry.py", "file_sha256": "492303f5a3f7ccfc62c65d211473b96a7de9f69af64227114fdcfd1ac673eead", "updated_ts": 1760763312.275142, "total_chunks": 4, "chunks": [{"sha": "a31ee9db2f46c3e38feae95781de7b78e7c19705a44ea17c7bead37a99644da9", "index": 0, "path": "5b7ee614__jinx__micro__llm__macro_registry.py\\a31ee9db2f46c3e38feae95781de7b78e7c19705a44ea17c7bead37a99644da9.json", "terms": ["str", "import", "from", "list", "async", "_handler", "_lock", "_registry", "def", "dict", "return", "_append", "blue_whispers", "asyncio", "awaitable", "callable", "dataclass", "default", "handler", "jinx", "macrocontext", "name", "namespace", "none", "with"], "text_preview": "from __future__ import annotations\n\nimport asyncio\nimport os\nimport re\nfrom dataclasses import dataclass\nfrom typing import Awaitable, Callable, Dict, List, Optional, Tuple\n\ntry:\n    from jinx.logger.file_logger import append_line as _append\n    from jinx.", "line_start": 1, "line_end": 52}, {"sha": "feb5a65499728294b94fbe3d9b9f8e1b55d4930701001f3e4eb90ed63e081128", "index": 1, "path": "5b7ee614__jinx__micro__llm__macro_registry.py\\feb5a65499728294b94fbe3d9b9f8e1b55d4930701001f3e4eb90ed63e081128.json", "terms": ["text", "str", "not", "args", "occ", "max_expansions", "int", "tuple", "end", "pos", "return", "args_blob", "break", "concurrently", "group", "occurrences", "once", "start", "while", "_gen_re", "expand_dynamic_macros", "all", "and", "append", "assembles"], "text_preview": "async def expand_dynamic_macros(text: str, ctx: MacroContext, *, max_expansions: int = 50) -> str:\n    \"\"\"Expand dynamic macros concurrently with per-call deduplication.\n\n    - Collects all macro occurrences first (up to max_expansions) to avoid repeated s", "line_start": 53, "line_end": 83}, {"sha": "23081325f67ee05547f49cea8e4765b40d8a882a14d5805a4615e133b3d99e55", "index": 2, "path": "5b7ee614__jinx__micro__llm__macro_registry.py\\23081325f67ee05547f49cea8e4765b40d8a882a14d5805a4615e133b3d99e55.json", "terms": ["str", "tuple", "args", "key", "results", "async", "conc", "not", "seen", "try", "_append", "uniq_keys", "set", "await", "dict", "except", "exception", "for", "getenv", "list", "macro", "reg", "sem", "semaphore", "val"], "text_preview": "async with _LOCK:\n        reg = dict(_REGISTRY)\n\n    # 3) Deduplicate macro calls for this pass\n    uniq_keys: List[Tuple[str, Tuple[str, ...]]] = []\n    seen: set[Tuple[str, Tuple[str, ...]]] = set()\n    for _, _, ns, args in occ:\n        key = (ns, args)", "line_start": 84, "line_end": 118}, {"sha": "885248f825c7176cce51b8766cc2ed335d102a918d9697231cda2adba55b904b", "index": 3, "path": "5b7ee614__jinx__micro__llm__macro_registry.py\\885248f825c7176cce51b8766cc2ed335d102a918d9697231cda2adba55b904b.json", "terms": ["out_parts", "args", "last", "append", "text", "asyncio", "end", "for", "start", "_run_one", "create_task", "uniq_keys", "assemble", "await", "except", "exception", "final", "gather", "get", "join", "list", "occ", "order", "pass", "preserving"], "text_preview": "except Exception:\n                    pass\n\n    await asyncio.gather(*[asyncio.create_task(_run_one(ns, args)) for ns, args in uniq_keys])\n\n    # 5) Assemble final text preserving order\n    out_parts: List[str] = []\n    last = 0\n    for start, end, ns, arg", "line_start": 119, "line_end": 132}], "file_terms": ["str", "args", "text", "tuple", "not", "list", "async", "import", "return", "occ", "out_parts", "asyncio", "append", "def", "dict", "end", "for", "from", "key", "results", "with", "_append", "_lock", "_registry", "int"]}