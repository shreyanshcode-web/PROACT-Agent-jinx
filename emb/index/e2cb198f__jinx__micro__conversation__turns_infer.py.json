{"file_rel": "jinx\\micro\\conversation\\turns_infer.py", "file_sha256": "122a59abfd4cf58099315a864a03b6239aef0eacc76bddfaa43cedcef687ef7b", "updated_ts": 1760763310.6102858, "total_chunks": 4, "chunks": [{"sha": "4280c91dfffafa08e49e81e26b084942dde633779595906978e31d0b390052d3", "index": 0, "path": "e2cb198f__jinx__micro__conversation__turns_infer.py\\4280c91dfffafa08e49e81e26b084942dde633779595906978e31d0b390052d3.json", "terms": ["import", "from", "str", "jinx", "obj", "return", "dict", "any", "micro", "none", "conversation", "def", "not", "optional", "_json_obj_re", "build_turns_instructions", "index", "kind", "frag", "get", "json", "try", "__future__", "_allowed_kinds", "_call_selector"], "text_preview": "from __future__ import annotations\n\nimport os\nimport json\nimport re\nfrom typing import Optional, Dict, Any\nimport time as _time\n\nfrom jinx.micro.conversation.turns_router import detect_turn_query as _fast_detect\nfrom jinx.micro.conversation.prefilter impor", "line_start": 1, "line_end": 43}, {"sha": "2095ff728023d60956c30e190d0909c5b5321e9cbb3441797421dd6a71db0f9b", "index": 1, "path": "e2cb198f__jinx__micro__conversation__turns_infer.py\\2095ff728023d60956c30e190d0909c5b5321e9cbb3441797421dd6a71db0f9b.json", "terms": ["none", "rel", "index", "compile", "except", "exception", "return", "role", "search", "try", "kind", "conf", "not", "_rel_last_re", "_rel_prev_re", "_role_jinx_re", "_role_user_re", "str", "confidence", "elif", "jinx", "last", "pair", "prev", "text"], "text_preview": "except Exception:\n        index = 0\n    try:\n        conf = float(obj.get(\"confidence\", 0.0))\n    except Exception:\n        conf = 0.0\n    if kind not in _ALLOWED_KINDS or index <= 0:\n        return None\n    return {\"kind\": kind, \"index\": index, \"confidenc", "line_start": 44, "line_end": 84}, {"sha": "9270a846159861c070e500c4e7074efef4db8dd3100bc914f2e1e84332843c60", "index": 2, "path": "e2cb198f__jinx__micro__conversation__turns_infer.py\\9270a846159861c070e500c4e7074efef4db8dd3100bc914f2e1e84332843c60.json", "terms": ["fast", "kind", "index", "return", "str", "rel", "idx", "llm", "not", "text", "turns", "await", "confidence", "except", "exception", "get", "int", "last", "lower", "none", "optional", "pair", "step", "try", "_allowed_kinds"], "text_preview": "turns = await _parse_turns()\n    except Exception:\n        turns = []\n    n = len(turns)\n    if n <= 0:\n        return None\n    idx = n if rel == \"last\" else (n - 1)\n    if idx <= 0:\n        return None\n    return {\"kind\": role, \"index\": idx, \"confidence\":", "line_start": 85, "line_end": 118}, {"sha": "508c85fd5150ee8726d49dc229c35d9b13632726d5b7ceb78adb7f57678e444c", "index": 3, "path": "e2cb198f__jinx__micro__conversation__turns_infer.py\\508c85fd5150ee8726d49dc229c35d9b13632726d5b7ceb78adb7f57678e444c.json", "terms": ["return", "fast", "obj", "text", "not", "use_llm", "except", "exception", "instr", "llm", "none", "now", "skip", "try", "until", "__all__", "_call_selector_json", "_cb_turns", "_extract_json", "_likely_turn", "_mk_instructions", "_time", "_validate", "base_extra_kwargs", "cb_name"], "text_preview": "use_llm = True\n    if not use_llm:\n        return fast  # may be None\n    # Prefilter: skip LLM when not likely a turns query\n    try:\n        if not _likely_turn(text or \"\"):\n            return fast\n    except Exception:\n        pass\n\n    # Circuit breake", "line_start": 119, "line_end": 158}], "file_terms": ["return", "kind", "fast", "none", "str", "not", "index", "import", "obj", "try", "except", "exception", "rel", "text", "from", "jinx", "dict", "any", "get", "optional", "compile", "def", "llm", "pair", "role"]}