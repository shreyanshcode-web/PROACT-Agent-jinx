{"file_rel": "jinx\\micro\\memory\\evergreen_select.py", "file_sha256": "7406ea58d6a45c72d577a850686c409dd3dcaba43f34c70d95d6105c9f7a3028", "updated_ts": 1760763312.3674195, "total_chunks": 5, "chunks": [{"sha": "09d82be7e75ded189472fc46aad4d291af16935c7d912642f6b37af28ea65331", "index": 0, "path": "37e48122__jinx__micro__memory__evergreen_select.py\\09d82be7e75ded189472fc46aad4d291af16935c7d912642f6b37af28ea65331.json", "terms": ["str", "cur", "import", "from", "list", "return", "time", "tuple", "append", "def", "except", "exception", "int", "len", "out", "try", "_fuzzy", "dict", "hashlib", "ignore", "join", "optional", "__future__", "_hash", "_now_ms"], "text_preview": "from __future__ import annotations\n\nimport hashlib\nimport os\nimport time\nfrom typing import Any, Dict, List, Optional, Tuple\n\ntry:\n    from rapidfuzz.fuzz import partial_ratio as _fuzzy\nexcept Exception:  # optional\n    _fuzzy = None  # type: ignore\n\nfrom ", "line_start": 1, "line_end": 51}, {"sha": "a0e1eb65cf0e525b376fa8a798967e1c2458da39b075274913eb7200d24081c4", "index": 1, "path": "37e48122__jinx__micro__memory__evergreen_select.py\\a0e1eb65cf0e525b376fa8a798967e1c2458da39b075274913eb7200d24081c4.json", "terms": ["str", "for", "score", "return", "q_tokens", "list", "strip", "and", "not", "qjoin", "sub", "_fuzzy", "anchor_tokens", "block", "blocks", "def", "float", "keep", "presence", "raw", "seen", "split", "uniq", "_score_block", "_split_blocks"], "text_preview": "for t in out:\n        if t not in seen:\n            seen.add(t)\n            uniq.append(t)\n    return uniq\n\n\ndef _split_blocks(md: str) -> List[str]:\n    # Split by double newlines; keep moderate sized paragraphs\n    raw = (md or \"\").strip().split(\"\\n\\n\")\n", "line_start": 52, "line_end": 91}, {"sha": "bde7076ba3c2798055d176211e81ffdf8473a2afff283d242ecca50e1e47e639", "index": 2, "path": "37e48122__jinx__micro__memory__evergreen_select.py\\bde7076ba3c2798055d176211e81ffdf8473a2afff283d242ecca50e1e47e639.json", "terms": ["none", "int", "str", "max_blocks", "max_chars", "max_time_ms", "optional", "ttl_ms", "not", "else", "getenv", "query", "try", "except", "exception", "anchors", "evergreen", "return", "small", "anchors_sha", "evergreen_sha", "jinx_evg_max_blocks", "jinx_evg_max_chars", "jinx_evg_max_time_ms", "jinx_evg_sel_ttl_ms"], "text_preview": "async def select_evergreen_for(query: str, anchors: Optional[Dict[str, List[str]]] = None, *, max_chars: Optional[int] = None, max_blocks: Optional[int] = None, max_time_ms: Optional[int] = None, ttl_ms: Optional[int] = None) -> str:\n    \"\"\"Return a small,", "line_start": 92, "line_end": 115}, {"sha": "d975a37ca45253c6fc675c30cf67b327c7fec09562891909c01bb402cfb19abb", "index": 3, "path": "37e48122__jinx__micro__memory__evergreen_select.py\\d975a37ca45253c6fc675c30cf67b327c7fec09562891909c01bb402cfb19abb.json", "terms": ["anchor_tokens", "anch_list", "ent", "for", "full", "list", "str", "ttl_ms", "_hash", "return", "max_time_ms", "_tokens", "anch_sha", "evg_sha", "perf_counter", "q_sha", "q_tokens", "time_up", "and", "append", "blocks", "except", "exception", "none", "not"], "text_preview": "except Exception:\n        ttl_ms = 2500\n\n    t0 = time.perf_counter()\n\n    def time_up() -> bool:\n        return max_time_ms is not None and (time.perf_counter() - t0) * 1000.0 > max_time_ms\n\n    full = (await read_evergreen()) or \"\"\n    if not full:\n     ", "line_start": 116, "line_end": 159}, {"sha": "9f8dacfa3388de101f35a2d29d01b99e300d07e0784140c2a715ecd266016e87", "index": 4, "path": "37e48122__jinx__micro__memory__evergreen_select.py\\9f8dacfa3388de101f35a2d29d01b99e300d07e0784140c2a715ecd266016e87.json", "terms": ["out_blocks", "out", "used", "len", "scored", "__all__", "_sc", "_sel_cache", "max_blocks", "max_chars", "select_evergreen_for", "append", "block", "blocks", "boundary", "break", "complete", "fewer", "for", "join", "key", "lambda", "list", "now", "prefer"], "text_preview": "scored.sort(key=lambda x: x[0], reverse=True)\n\n    out_blocks: List[str] = []\n    used = 0\n    for _sc, b in scored[: max_blocks or 6]:\n        if used + len(b) + 2 > (max_chars or 1200):\n            # try to truncate at block boundary; prefer fewer comple", "line_start": 160, "line_end": 177}], "file_terms": ["str", "return", "none", "list", "for", "int", "not", "try", "except", "exception", "max_time_ms", "ttl_ms", "anchor_tokens", "optional", "append", "cur", "def", "import", "out", "max_blocks", "max_chars", "time", "and", "len", "q_tokens"]}