{"file_rel": "jinx\\micro\\embeddings\\search_cache.py", "file_sha256": "495545638e77b099718ec527d6a1b7460a6cf0691142d059a1a30af28682d451", "updated_ts": 1760763311.7828655, "total_chunks": 3, "chunks": [{"sha": "80047ff9e138c4e9904831d4a18456364e967db99affdafd94f39a90fc98ee09", "index": 0, "path": "81611327__jinx__micro__embeddings__search_cache.py\\80047ff9e138c4e9904831d4a18456364e967db99affdafd94f39a90fc98ee09.json", "terms": ["import", "int", "str", "from", "dict", "tuple", "_max_conc", "time", "asyncio", "except", "exception", "float", "getenv", "optional", "try", "_append", "_dump", "_ttl_sec", "blue_whispers", "any", "def", "jinx", "line", "list", "return"], "text_preview": "from __future__ import annotations\n\nimport asyncio\nimport os\nimport time\nfrom typing import Any, Dict, List, Tuple, Optional\n\nfrom .project_search_api import search_project as _search_project\n\n# Lightweight in-memory TTL cache + request coalescing for proj", "line_start": 1, "line_end": 39}, {"sha": "864ec181b490159d4d4191abff9c3c737d144ee6e03cac16bc692f8575c12a6b", "index": 1, "path": "81611327__jinx__micro__embeddings__search_cache.py\\864ec181b490159d4d4191abff9c3c737d144ee6e03cac16bc692f8575c12a6b.json", "terms": ["int", "none", "str", "max_time_ms", "key", "optional", "data", "def", "query", "return", "_mem", "any", "dict", "list", "not", "tuple", "_now", "k_eff", "default", "cache", "else", "exp", "for", "max", "_cache_get"], "text_preview": "pass\n\n\ndef _key(query: str, k: int, max_time_ms: Optional[int]) -> Tuple[str, int, Optional[int]]:\n    q = (query or \"\").strip()\n    return (q, int(max(1, k)), int(max_time_ms) if (max_time_ms is not None) else None)\n\n\ndef _cache_get(key: Tuple[str, int, O", "line_start": 40, "line_end": 72}, {"sha": "6b68d77ac2bcbbb08a42308f09d8a3b149eba4a0431e5ebb064edb051e533a7f", "index": 2, "path": "81611327__jinx__micro__embeddings__search_cache.py\\6b68d77ac2bcbbb08a42308f09d8a3b149eba4a0431e5ebb064edb051e533a7f.json", "terms": ["fut", "key", "k_eff", "return", "max_time_ms", "except", "exception", "res", "try", "_inflight", "await", "none", "query", "set_result", "async", "loop", "not", "_cache_get", "_cache_put", "_dump_line", "_key", "_search_project", "_sem", "create_future", "embed_project_top_k"], "text_preview": "try:\n            k_eff = int(os.getenv(\"EMBED_PROJECT_TOP_K\", \"20\"))\n        except Exception:\n            k_eff = 20\n    key = _key(query, k_eff, max_time_ms)\n    c = _cache_get(key)\n    if c is not None:\n        return c\n\n    fut = _inflight.get(key)\n   ", "line_start": 73, "line_end": 107}], "file_terms": ["int", "none", "str", "key", "return", "max_time_ms", "optional", "import", "k_eff", "dict", "tuple", "except", "exception", "fut", "query", "try", "def", "not", "any", "from", "list", "_inflight", "_mem", "time", "async"]}