{"file_rel": "jinx\\micro\\conversation\\turns_router.py", "file_sha256": "57e18ddc3d6a4d5914ef7899a3b780bc95d9265d78a7d7348b0d337a466b06b4", "updated_ts": 1760763310.6130757, "total_chunks": 3, "chunks": [{"sha": "1104a4cbd59c8f22b53d9f08a5fa2d5cac95b27ce407a39f2802990f76502f87", "index": 0, "path": "2a9206da__jinx__micro__conversation__turns_router.py\\1104a4cbd59c8f22b53d9f08a5fa2d5cac95b27ce407a39f2802990f76502f87.json", "terms": ["jinx", "compile", "user", "import", "_roman_map", "from", "int", "message", "msg", "prev", "step", "str", "turn", "сообщ", "ход", "шаг", "__future__", "_any_int", "_fullwidth", "_near_msg_patterns", "_role_tokens", "_roman_re", "_roman_to_int", "agent", "agnostic"], "text_preview": "from __future__ import annotations\n\nimport re\nfrom typing import Optional, Dict\n\n# Language-agnostic turns detection.\n# Returns {\"kind\": \"user|jinx|pair\", \"index\": int} or None.\n\n_FULLWIDTH = str.maketrans({\n    \"０\":\"0\",\"１\":\"1\",\"２\":\"2\",\"３\":\"3\",\"４\":\"4\",\"５\":", "line_start": 1, "line_end": 45}, {"sha": "fab77b68c88a30d8a64ce0995eb1fc49c112a21d3e807de7a9b3b08d1cc4b6cc", "index": 1, "path": "2a9206da__jinx__micro__conversation__turns_router.py\\fab77b68c88a30d8a64ce0995eb1fc49c112a21d3e807de7a9b3b08d1cc4b6cc.json", "terms": ["return", "none", "raw", "text", "try", "role", "str", "else", "group", "int", "search", "total", "_fullwidth", "def", "except", "exception", "explicit", "for", "tok", "translate", "_any_int", "_detect_kind", "_extract_index", "_near_msg_patterns", "_role_tokens"], "text_preview": "total -= v\n        else:\n            total += v\n            prev = v\n    return total\n\n\ndef _extract_index(text: str) -> Optional[int]:\n    t = (text or \"\").strip()\n    if not t:\n        return None\n    # 1) Try explicit nearby message markers\n    for rx i", "line_start": 46, "line_end": 89}, {"sha": "5c50785af673d9706414ada5148e4246555ce34fe083c5d1090a90dcef7be6f6", "index": 2, "path": "2a9206da__jinx__micro__conversation__turns_router.py\\5c50785af673d9706414ada5148e4246555ce34fe083c5d1090a90dcef7be6f6.json", "terms": ["kind", "return", "idx", "text", "str", "detect_turn_query", "pair", "__all__", "_detect_kind", "_extract_index", "and", "def", "default", "dict", "index", "int", "none", "not", "object", "optional", "role", "safer", "still", "useful"], "text_preview": "return role\n    # Default to pair (safer and still useful)\n    return \"pair\"\n\n\ndef detect_turn_query(text: str) -> Optional[Dict[str, object]]:\n    idx = _extract_index(text)\n    if not idx:\n        return None\n    kind = _detect_kind(text)\n    return {\"ki", "line_start": 90, "line_end": 103}], "file_terms": ["return", "str", "text", "jinx", "compile", "int", "none", "user", "kind", "role", "def", "raw", "total", "try", "_fullwidth", "else", "explicit", "for", "group", "idx", "import", "message", "optional", "pair", "prev"]}