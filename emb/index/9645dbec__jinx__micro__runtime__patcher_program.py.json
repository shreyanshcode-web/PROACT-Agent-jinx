{"file_rel": "jinx\\micro\\runtime\\patcher_program.py", "file_sha256": "a946cb798aad6a4b737f0dac8c178eaa7089847c563f3aa202b75afaf9931fdd", "updated_ts": 1760763312.8664522, "total_chunks": 13, "chunks": [{"sha": "3dead0d6d5ecb872e842cb38847375d6a252eb9a71e560f53f095cb136c585bd", "index": 0, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\3dead0d6d5ecb872e842cb38847375d6a252eb9a71e560f53f095cb136c585bd.json", "terms": ["import", "from", "jinx", "micro", "patch", "runtime", "task_request", "args", "kwargs", "line", "microprogram", "name", "path", "__future__", "_h_anchor", "_h_auto", "_h_batch", "_h_dump_query", "_h_dump_query_global", "_h_dump_symbol", "_h_line", "_h_refactor_move", "_h_refactor_split", "_h_symbol", "_h_write"], "text_preview": "from __future__ import annotations\n\nimport asyncio\nimport os\nfrom typing import Any, Optional, List, Dict\n\nfrom .program import MicroProgram\nfrom .api import on\nfrom .contracts import TASK_REQUEST\nfrom jinx.micro.runtime.patch import AutoPatchArgs\nfrom jin", "line_start": 1, "line_end": 32}, {"sha": "c75f18c26e4f71ec33e2b042469d74bc43d0270113e76204bc62fad41a823d16", "index": 1, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\c75f18c26e4f71ec33e2b042469d74bc43d0270113e76204bc62fad41a823d16.json", "terms": ["str", "bool", "symbol", "src_path", "patch", "anchor", "query", "include_decorators", "include_docstring", "out_path", "args", "dump", "force", "kwargs", "name", "path", "refactor", "create_init", "insert_shim", "code", "replacement", "dst_path", "line_end", "line_start", "out_dir"], "text_preview": "- \"patch.symbol\": {id, name, args: [path, symbol, replacement], kwargs: {}}\n    - \"patch.anchor\": {id, name, args: [path, anchor, replacement], kwargs: {}}\n    - \"patch.auto\": {id, name, args: [], kwargs: {path?, code?, line_start?, line_end?, symbol?, anc", "line_start": 33, "line_end": 47}, {"sha": "8a67da5b630810d668c0d60ab1ec2e11c65a13afa7c16af913038d965c067f50", "index": 2, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\8a67da5b630810d668c0d60ab1ec2e11c65a13afa7c16af913038d965c067f50.json", "terms": ["str", "self", "val", "cap", "def", "none", "return", "async", "except", "exception", "try", "__init__", "export", "diff", "exports", "files", "for", "goal", "key", "_maybe_verify", "_verify_cb", "get_export", "jinx_patch_export_maxchars", "last_patch_", "adds"], "text_preview": "- Best-effort, async, non-blocking. All I/O uses aiofiles.\n    - Adds progress + final result to the bus for observability.\n    \"\"\"\n\n    def __init__(self) -> None:\n        super().__init__(name=\"AutoPatchProgram\")\n        # Lightweight export surface for ", "line_start": 48, "line_end": 80}, {"sha": "2bb0fe645f91442c550c8e4ebd3f8e9ab9ee96ea5f8788d576d645aa51cc192e", "index": 3, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\2bb0fe645f91442c550c8e4ebd3f8e9ab9ee96ea5f8788d576d645aa51cc192e.json", "terms": ["args", "str", "name", "await", "payload", "self", "get", "path", "tid", "return", "_on_task", "not", "int", "len", "patch", "replacement", "text", "_handle_line_patch", "_handle_write", "task_request", "alive", "async", "asynchronously", "asyncio", "bus"], "text_preview": "# Subscribe to task requests once; event bus dispatches asynchronously\n        await on(TASK_REQUEST, self._on_task)\n        await self.log(\"patcher online\")\n        # Idle loop to keep program alive until stopped\n        while True:\n            await asyn", "line_start": 81, "line_end": 109}, {"sha": "3477918928bfb1dfe97db0979f52d7a115c38ca92e2c3417c3da8854104f797a", "index": 4, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\3477918928bfb1dfe97db0979f52d7a115c38ca92e2c3417c3da8854104f797a.json", "terms": ["args", "get", "str", "path", "none", "replacement", "line_start", "code", "anchor", "await", "elif", "name", "patch", "payload", "self", "symbol", "tid", "else", "len", "not", "return", "_handle_anchor_patch", "_handle_auto_patch", "_handle_symbol_patch", "auto"], "text_preview": "elif name == \"patch.symbol\":\n                args = payload.get(\"args\") or []\n                if len(args) < 3:\n                    return\n                path = str(args[0])\n                symbol = str(args[1])\n                replacement = str(args[2])\n", "line_start": 110, "line_end": 133}, {"sha": "c98b2623bf150643f01276a988a03a18a5ac9cc1d029e7bce9631b4c918dabfe", "index": 5, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\c98b2623bf150643f01276a988a03a18a5ac9cc1d029e7bce9631b4c918dabfe.json", "terms": ["none", "get", "str", "context_tolerance", "line_end", "max_span", "force", "ops", "symbol", "bool", "else", "false", "not", "context_before", "src_path", "anchor", "preview", "query", "elif", "int", "kwargs", "name", "payload", "_handle_batch_patch", "await"], "text_preview": "line_end=int(kw.get(\"line_end\")) if kw.get(\"line_end\") is not None else None,\n                        symbol=str(kw.get(\"symbol\") or \"\") or None,\n                        anchor=str(kw.get(\"anchor\") or \"\") or None,\n                        query=str(kw.get(\"", "line_start": 134, "line_end": 151}, {"sha": "9802f68fea53092886feb0a2bcc87ca75fb5b4ab5396032c85756d978ab6844e", "index": 6, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\9802f68fea53092886feb0a2bcc87ca75fb5b4ab5396032c85756d978ab6844e.json", "terms": ["include_decorators", "include_docstring", "get", "out_path", "str", "src_path", "none", "query", "symbol", "await", "bool", "else", "not", "self", "tid", "_handle_dump_by_query", "_handle_dump_symbol", "dump", "elif", "kwargs", "name", "payload"], "text_preview": "symbol = str(kw.get(\"symbol\") or \"\")\n                out_path = str(kw.get(\"out_path\") or \"\")\n                include_decorators = kw.get(\"include_decorators\")\n                include_docstring = kw.get(\"include_docstring\")\n                await self._hand", "line_start": 152, "line_end": 175}, {"sha": "f5687c56b7b9119c30a867b38bd7b0db8f59d6ae48e6e53863612e7ff97e417a", "index": 7, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\f5687c56b7b9119c30a867b38bd7b0db8f59d6ae48e6e53863612e7ff97e417a.json", "terms": ["none", "include_decorators", "include_docstring", "get", "topk", "else", "not", "bool", "out_path", "query", "str", "src_path", "elif", "kwargs", "name", "payload", "_handle_dump_by_query_global", "query_global", "await", "dump", "int", "move", "refactor", "self", "tid"], "text_preview": "include_decorators=bool(include_decorators) if include_decorators is not None else None,\n                    include_docstring=bool(include_docstring) if include_docstring is not None else None,\n                )\n            elif name == \"dump.query_global", "line_start": 176, "line_end": 196}, {"sha": "1eb2e77ca69405169002e4b5f2984e0ca592ef00d276160d438a949fbb269694", "index": 8, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\1eb2e77ca69405169002e4b5f2984e0ca592ef00d276160d438a949fbb269694.json", "terms": ["create_init", "insert_shim", "force", "get", "none", "src_path", "str", "dst_path", "out_dir", "symbol", "bool", "else", "not", "await", "self", "tid", "_handle_refactor_move", "_handle_refactor_split", "elif", "kwargs", "name", "payload", "refactor", "split"], "text_preview": "symbol = str(kw.get(\"symbol\") or \"\")\n                dst_path = str(kw.get(\"dst_path\") or \"\")\n                create_init = kw.get(\"create_init\")\n                insert_shim = kw.get(\"insert_shim\")\n                force = kw.get(\"force\")\n                aw", "line_start": 197, "line_end": 221}, {"sha": "863b38433e1994d07d7d0a6cc1d253e3a9f690cae680ca2c923a8325d6caf5e3", "index": 9, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\863b38433e1994d07d7d0a6cc1d253e3a9f690cae680ca2c923a8325d6caf5e3.json", "terms": ["str", "exports", "self", "none", "path", "tid", "replacement", "_verify_cb", "verify_cb", "create_init", "insert_shim", "async", "await", "def", "not", "force", "bool", "else", "int", "anchor", "symbol", "text", "_h_anchor", "_h_line", "_h_symbol"], "text_preview": "create_init=bool(create_init) if create_init is not None else None,\n                    insert_shim=bool(insert_shim) if insert_shim is not None else None,\n                    force=bool(force) if force is not None else None,\n                )\n        exce", "line_start": 222, "line_end": 241}, {"sha": "3d0aca1249f8cecedd43e5c5cd12126a03b7505212932667930a73d568c4275e", "index": 10, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\3d0aca1249f8cecedd43e5c5cd12126a03b7505212932667930a73d568c4275e.json", "terms": ["str", "self", "none", "tid", "exports", "bool", "include_decorators", "include_docstring", "src_path", "async", "await", "def", "_verify_cb", "out_path", "verify_cb", "force", "ops", "symbol", "_h_auto", "_h_batch", "_h_dump_query", "_h_dump_symbol", "_handle_auto_patch", "_handle_batch_patch", "_handle_dump_by_query"], "text_preview": "async def _handle_auto_patch(self, tid: str, a: AutoPatchArgs) -> None:\n        await _h_auto(tid, a, verify_cb=self._verify_cb, exports=self.exports)\n\n    async def _handle_batch_patch(self, tid: str, ops: List[Dict[str, Any]], force: bool) -> None:\n     ", "line_start": 242, "line_end": 281}, {"sha": "012b2c42615dc6310c2eb76411f514f1b203dc8be756632ab2137fde7d991a0d", "index": 11, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\012b2c42615dc6310c2eb76411f514f1b203dc8be756632ab2137fde7d991a0d.json", "terms": ["none", "self", "str", "include_decorators", "include_docstring", "bool", "exports", "tid", "_verify_cb", "out_path", "verify_cb", "topk", "query", "dst_path", "src_path", "async", "await", "def", "symbol", "_h_dump_query_global", "_h_refactor_move", "_handle_dump_by_query_global", "_handle_refactor_move", "create_init", "insert_shim"], "text_preview": "query,\n            out_path,\n            include_decorators=include_decorators,\n            include_docstring=include_docstring,\n            verify_cb=self._verify_cb,\n            exports=self.exports,\n        )\n\n    async def _handle_dump_by_query_global(", "line_start": 282, "line_end": 327}, {"sha": "d6b048503b688379a74fff175e8079bc03018978449eb835dbf03c7cdeecc9dc", "index": 12, "path": "9645dbec__jinx__micro__runtime__patcher_program.py\\d6b048503b688379a74fff175e8079bc03018978449eb835dbf03c7cdeecc9dc.json", "terms": ["create_init", "insert_shim", "force", "exports", "none", "self", "bool", "str", "out_dir", "src_path", "tid", "_h_refactor_split", "_handle_refactor_split", "_verify_cb", "verify_cb", "async", "await", "def"], "text_preview": "exports=self.exports,\n            create_init=create_init,\n            insert_shim=insert_shim,\n            force=force,\n        )\n\n    async def _handle_refactor_split(\n        self,\n        tid: str,\n        src_path: str,\n        out_dir: str,\n        *", "line_start": 328, "line_end": 353}], "file_terms": ["str", "none", "get", "self", "bool", "args", "tid", "include_decorators", "include_docstring", "src_path", "name", "await", "exports", "force", "symbol", "path", "not", "create_init", "insert_shim", "out_path", "else", "kwargs", "query", "def", "async"]}