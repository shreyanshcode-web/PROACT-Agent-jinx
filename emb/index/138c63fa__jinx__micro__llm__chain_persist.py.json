{"file_rel": "jinx\\micro\\llm\\chain_persist.py", "file_sha256": "3c8b78698b54cf67d563a0ae0a0bd0671e456ef218636cf2c5a28d7fcbc91dd1", "updated_ts": 1760763312.0759494, "total_chunks": 5, "chunks": [{"sha": "ce172d5076778bbdb449075b7e45da2bf7f4da77eebaf25d61c9e06fdccd42bf", "index": 0, "path": "138c63fa__jinx__micro__llm__chain_persist.py\\ce172d5076778bbdb449075b7e45da2bf7f4da77eebaf25d61c9e06fdccd42bf.json", "terms": ["str", "import", "root", "def", "from", "jinx", "join", "project_root", "time", "path", "return", "_brain_dir", "jinx_brain_dir", "rel_dir", "any", "brain", "dict", "embeddings", "files", "getenv", "int", "plan", "project", "__future__", "_memory_dir"], "text_preview": "from __future__ import annotations\n\nimport os\nimport time\nfrom typing import Any, Dict\n\nfrom jinx.async_utils.fs import write_text\nfrom jinx.micro.embeddings.project_config import ROOT as PROJECT_ROOT\n\n\ndef _brain_dir() -> str:\n    return os.getenv(\"JINX_B", "line_start": 1, "line_end": 37}, {"sha": "2d9d4de5ee848b370ca10c045eb6f11a022ada2a788198d614be49863a39bb85", "index": 1, "path": "138c63fa__jinx__micro__llm__chain_persist.py\\2d9d4de5ee848b370ca10c045eb6f11a022ada2a788198d614be49863a39bb85.json", "terms": ["lines", "append", "goal", "get", "steps", "plan", "str", "strip", "ts_ms", "path", "criteria", "fname", "isinstance", "slug", "step", "why", "_safe_name", "out_dir", "sub_queries", "user_text", "and", "compose", "content", "continue", "dict"], "text_preview": "goal = str(plan.get(\"goal\") or \"\").strip()\n        slug = _safe_name(goal or (user_text or \"\"))\n        fname = f\"{ts_ms}_{slug}.md\"\n        path = os.path.join(out_dir, fname)\n        # Compose content (markdown)\n        lines = []\n        lines.append(f\"", "line_start": 38, "line_end": 66}, {"sha": "0498448d7f709df659998c7eb04ea0ca61e61de9ef2294726ad4c964834d2503", "index": 2, "path": "138c63fa__jinx__micro__llm__chain_persist.py\\0498448d7f709df659998c7eb04ea0ca61e61de9ef2294726ad4c964834d2503.json", "terms": ["lines", "append", "strip", "cortex", "risks", "note", "subs", "and", "str", "merged_context", "cvs", "for", "get", "isinstance", "plan", "rks", "sqs", "utxt", "body", "list", "user_text", "write_text", "await", "dict", "items"], "text_preview": "if isinstance(subs, list) and subs:\n            lines.append(\"subs:\")\n            for sq in subs:\n                sqs = str(sq or \"\").strip()\n                if sqs:\n                    lines.append(f\"  - {sqs}\")\n        risks = plan.get(\"risks\") or []\n   ", "line_start": 67, "line_end": 97}, {"sha": "9a6737e2c0c360f9931ebf836f067b83169e5574744fefc7f66592c40fe71608", "index": 3, "path": "138c63fa__jinx__micro__llm__chain_persist.py\\9a6737e2c0c360f9931ebf836f067b83169e5574744fefc7f66592c40fe71608.json", "terms": ["str", "tag", "_re", "mem_text", "path", "slug", "out_dir", "plan_goal", "project_root", "rel_dir", "ts_ms", "user_text", "time", "def", "fname", "join", "return", "root", "text", "_memory_dir", "_safe_name", "_strip_wrapped", "evergreen_text", "jinx_memory_dir", "persist_memory"], "text_preview": "except Exception:\n        # Non-fatal persistence\n        return\n\n\nasync def persist_memory(mem_text: str, evergreen_text: str, *, user_text: str = \"\", plan_goal: str = \"\") -> None:\n    \"\"\"Persist memory snapshot (sanitized transcript + evergreen) as a mar", "line_start": 98, "line_end": 125}, {"sha": "d92f516935433c7dd2e7a40ee441690b58864e09d7998d801302a13b25147fa0", "index": 4, "path": "138c63fa__jinx__micro__llm__chain_persist.py\\d92f516935433c7dd2e7a40ee441690b58864e09d7998d801302a13b25147fa0.json", "terms": ["lines", "append", "evg_raw", "mem_raw", "ts_ms", "_strip_wrapped", "plan_goal", "user_text", "body", "evergreen", "for", "memory", "return", "splitlines", "evergreen_text", "mem_text", "write_text", "await", "else", "except", "exception", "goal", "group", "join", "path"], "text_preview": "return (m.group(1).strip() if m else t)\n\n        mem_raw = _strip_wrapped(\"memory\", mem_text)\n        evg_raw = _strip_wrapped(\"evergreen\", evergreen_text)\n\n        lines = []\n        lines.append(\"---\")\n        lines.append(f\"ts_ms: {ts_ms}\")\n        if p", "line_start": 126, "line_end": 150}], "file_terms": ["lines", "append", "str", "strip", "path", "plan", "ts_ms", "get", "join", "user_text", "goal", "for", "import", "return", "root", "cortex", "risks", "and", "def", "slug", "project_root", "note", "tag", "time", "steps"]}