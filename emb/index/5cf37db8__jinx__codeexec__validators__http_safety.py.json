{"file_rel": "jinx\\codeexec\\validators\\http_safety.py", "file_sha256": "3ff3d729cc72ec519f4e4e09c552664b618c0e2ca2c86db1b09b849cd102ebd5", "updated_ts": 1760763309.9933197, "total_chunks": 4, "chunks": [{"sha": "6ee17928b27175a15024e3fda0d7a7ac0850ec13f06a5a216f768b0b20b4ee75", "index": 0, "path": "5cf37db8__jinx__codeexec__validators__http_safety.py\\6ee17928b27175a15024e3fda0d7a7ac0850ec13f06a5a216f768b0b20b4ee75.json", "terms": ["ast", "value", "func", "and", "isinstance", "return", "import", "node", "def", "from", "name", "call", "attribute", "float", "optional", "attr", "bool", "delete", "get", "head", "none", "options", "post", "put", "request"], "text_preview": "from __future__ import annotations\n\nfrom typing import Optional\nimport ast\n\nfrom .ast_cache import get_ast\nfrom .config import is_enabled, HTTP_MAX_TIMEOUT as _MAX_TIMEOUT\n\n\ndef _const_num(node: ast.AST) -> Optional[float]:\n    if isinstance(node, ast.Cons", "line_start": 1, "line_end": 40}, {"sha": "2a9684d2c1ed5ac871bc69acae0a6e86f4d703b0de73b368b9c8d7eb7af1dd31", "index": 1, "path": "5cf37db8__jinx__codeexec__validators__http_safety.py\\2a9684d2c1ed5ac871bc69acae0a6e86f4d703b0de73b368b9c8d7eb7af1dd31.json", "terms": ["ast", "and", "func", "isinstance", "value", "httpx", "aiohttp", "attr", "attribute", "bool", "def", "name", "request", "return", "asyncclient", "client", "delete", "get", "head", "options", "patch", "post", "put", "_is_aiohttp_request", "_is_aiohttp_session_ctor"], "text_preview": "and func.attr == \"urlopen\"\n    )\n\n\ndef _is_httpx_direct_call(func: ast.AST) -> bool:\n    # httpx.get/post/put/delete/head/options/patch/request\n    return (\n        isinstance(func, ast.Attribute)\n        and isinstance(func.value, ast.Name)\n        and fu", "line_start": 41, "line_end": 80}, {"sha": "4fd8183d254cdfe02604460645e3751ad05538ae9ea7c3c93d0c10dbca9857c7", "index": 2, "path": "5cf37db8__jinx__codeexec__validators__http_safety.py\\4fd8183d254cdfe02604460645e3751ad05538ae9ea7c3c93d0c10dbca9857c7.json", "terms": ["and", "none", "return", "timeout", "verify", "ast", "not", "_is_httpx_direct_call", "_is_requests_call", "_kw_value", "_max_timeout", "str", "call", "code", "false", "for", "func", "isinstance", "require", "true", "10s", "_const_num", "_is_aiohttp_request", "_is_urlopen_call", "check_http_safety"], "text_preview": "and func.attr == \"ClientSession\"\n    )\n\n\ndef check_http_safety(code: str) -> Optional[str]:\n    if not is_enabled(\"http_safety\", True):\n        return None\n    t = get_ast(code)\n    if not t:\n        return None\n    for n in ast.walk(t):\n        if isinsta", "line_start": 81, "line_end": 106}, {"sha": "96d977ad3003a3b57a0e0452605c33e07037ded666cbc0081b097ca8b80e1423", "index": 3, "path": "5cf37db8__jinx__codeexec__validators__http_safety.py\\96d977ad3003a3b57a0e0452605c33e07037ded666cbc0081b097ca8b80e1423.json", "terms": ["return", "false", "timeout", "_kw_value", "aiohttp", "none", "ssl", "client", "disallowed", "explicit", "requires", "with", "_is_aiohttp_request", "_is_aiohttp_session_ctor", "_is_httpx_client_ctor", "also", "and", "ast", "clientsession", "constant", "constructors", "for", "httpx", "isinstance", "provide"], "text_preview": "return \"requests.* with verify=False is disallowed\"\n                # For aiohttp: ssl=False is unsafe\n                if _is_aiohttp_request(fn):\n                    sv = _kw_value(n, \"ssl\")\n                    if isinstance(sv, ast.Constant) and sv.value", "line_start": 107, "line_end": 122}], "file_terms": ["ast", "func", "and", "value", "return", "isinstance", "def", "none", "name", "timeout", "aiohttp", "attr", "attribute", "request", "_kw_value", "httpx", "bool", "false", "call", "import", "node", "verify", "client", "delete", "for"]}