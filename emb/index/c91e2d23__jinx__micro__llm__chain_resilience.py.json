{"file_rel": "jinx\\micro\\llm\\chain_resilience.py", "file_sha256": "9ad028075a1ef9ec51eb154d25051499abce43ba4bb563f8fc2559d6c764bdd2", "updated_ts": 1760763312.1205957, "total_chunks": 4, "chunks": [{"sha": "fa01d5f3f1efad3e30315a59d741302bc23380e10a0aa21bca3dd48e03eecc87", "index": 0, "path": "c91e2d23__jinx__micro__llm__chain_resilience.py\\fa01d5f3f1efad3e30315a59d741302bc23380e10a0aa21bca3dd48e03eecc87.json", "terms": ["import", "return", "chain_state", "def", "dict", "none", "any", "async", "asyncio", "await", "from", "json", "str", "_dump", "_load", "_read_state", "to_thread", "encoding", "except", "exception", "not", "open", "path", "try", "utf"], "text_preview": "from __future__ import annotations\n\nimport asyncio\nimport json\nimport os\nimport time\nfrom typing import Any, Dict\n\nfrom jinx.log_paths import CHAIN_STATE\n\n_DEFAULT_DISABLE_MS = 60_000  # 1 minute\n\n\nasync def _read_state() -> Dict[str, Any]:\n    try:\n      ", "line_start": 1, "line_end": 44}, {"sha": "ebf08309d0f6f12428a6039f7fb91c7b8cf84d3cf7d0c6e7ec2e8ec8136aecd3", "index": 1, "path": "c91e2d23__jinx__micro__llm__chain_resilience.py\\ebf08309d0f6f12428a6039f7fb91c7b8cf84d3cf7d0c6e7ec2e8ec8136aecd3.json", "terms": ["int", "none", "get", "fail_count", "kinds", "kind", "await", "except", "exception", "try", "until", "_read_state", "disable_until_ms", "now_ms", "time", "and", "async", "def", "default", "dict", "disable", "failure", "isinstance", "not", "now"], "text_preview": "return True\n    try:\n        until = int(st.get(\"disable_until_ms\") or 0)\n    except Exception:\n        until = 0\n    now = int(now_ms or time.time() * 1000)\n    return now >= until\n\n\nasync def record_success() -> None:\n    st = await _read_state()\n    if ", "line_start": 45, "line_end": 87}, {"sha": "9fae24ccce1e7c4ded875e89819e2c78fc9d88c6fc6c7d9a34924e8635e1ed01", "index": 2, "path": "c91e2d23__jinx__micro__llm__chain_resilience.py\\9fae24ccce1e7c4ded875e89819e2c78fc9d88c6fc6c7d9a34924e8635e1ed01.json", "terms": ["plan", "get", "_os", "time", "int", "disable_ms", "dict", "thr", "sub_queries", "_default_disable_ms", "cortex", "goal", "kinds", "note", "risks", "await", "except", "exception", "getenv", "import", "isinstance", "keep", "max", "not", "now"], "text_preview": "st[\"kinds\"] = kinds\n    # Threshold logic\n    try:\n        import os as _os\n        thr = max(1, int(_os.getenv(\"JINX_CHAINED_FAIL_THRESHOLD\", \"3\")))\n    except Exception:\n        thr = 3\n    try:\n        import os as _os\n        disable_ms = max(10_000, i", "line_start": 88, "line_end": 123}, {"sha": "85dab3bcc0817a255548732e7d9131d65f24bcd0e9ddaa4beb4e02861f97b60a", "index": 3, "path": "c91e2d23__jinx__micro__llm__chain_resilience.py\\85dab3bcc0817a255548732e7d9131d65f24bcd0e9ddaa4beb4e02861f97b60a.json", "terms": ["dict", "none", "last_plan", "await", "isinstance", "return", "_read_state", "_write_state", "load_last_plan", "any", "async", "def", "else", "get", "keep", "last", "load", "not", "output", "planner", "present", "str", "successful", "the"], "text_preview": "}\n    st[\"last_plan\"] = keep\n    await _write_state(st)\n\n\nasync def load_last_plan() -> Dict[str, Any] | None:\n    \"\"\"Load the last successful planner output if present.\"\"\"\n    st = await _read_state()\n    if not isinstance(st, dict):\n        return None\n ", "line_start": 124, "line_end": 135}], "file_terms": ["none", "dict", "get", "int", "return", "plan", "await", "def", "import", "time", "async", "except", "exception", "isinstance", "not", "str", "try", "_read_state", "kinds", "any", "chain_state", "fail_count", "_os", "_write_state", "now_ms"]}