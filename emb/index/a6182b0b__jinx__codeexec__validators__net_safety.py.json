{"file_rel": "jinx\\codeexec\\validators\\net_safety.py", "file_sha256": "b38a517bf379d837c91ae56d3e91d66615ac45b48a0a102ec4bd58a5c3952ff3", "updated_ts": 1760763310.0164196, "total_chunks": 4, "chunks": [{"sha": "b8e3b9d17987af1ad8dd8394364b9e3e56e20b31773e3961c0bb37a1a65f3848", "index": 0, "path": "a6182b0b__jinx__codeexec__validators__net_safety.py\\b8e3b9d17987af1ad8dd8394364b9e3e56e20b31773e3961c0bb37a1a65f3848.json", "terms": ["ast", "node", "isinstance", "import", "return", "and", "call", "str", "from", "name", "value", "def", "bool", "_is_attr_name", "arg0", "attr_name", "check_call", "mod_name", "args", "false", "list", "none", "not", "optional", "subprocess"], "text_preview": "from __future__ import annotations\n\nfrom typing import Optional\nimport ast\n\nfrom .ast_cache import get_ast\nfrom .config import is_enabled\nfrom .policy import (\n    BANNED_NET_MODS as _BANNED_MODS,\n    BANNED_NET_FUNCS as _BANNED_FUNCS,\n    BANNED_NET_FROM ", "line_start": 1, "line_end": 39}, {"sha": "6f6b1f1f84d448a64a124abbd291b9e9ede278df89211cfdff27156fe53cf8e0", "index": 1, "path": "a6182b0b__jinx__codeexec__validators__net_safety.py\\6f6b1f1f84d448a64a124abbd291b9e9ede278df89211cfdff27156fe53cf8e0.json", "terms": ["seq", "return", "and", "_const_str", "false", "not", "ast", "call", "arg0", "open", "isinstance", "cmd", "len", "url", "value", "args", "elts", "executable", "install", "pip", "popen", "start", "subprocess", "sys", "true"], "text_preview": "seq = arg0.elts\n    if not seq or len(seq) < 4:\n        return False\n    # [sys.executable, '-m', 'pip', 'install', ...]\n    a0 = seq[0]\n    if not (isinstance(a0, ast.Attribute) and isinstance(a0.value, ast.Name) and a0.value.id == \"sys\" and a0.attr == \"e", "line_start": 40, "line_end": 74}, {"sha": "90610c57367031cb89877d144844d4f011659bf164c10cacb4efa8690f91d0ec", "index": 2, "path": "a6182b0b__jinx__codeexec__validators__net_safety.py\\90610c57367031cb89877d144844d4f011659bf164c10cacb4efa8690f91d0ec.json", "terms": ["return", "subprocess", "ast", "for", "name", "run", "disallowed", "import", "isinstance", "mod", "none", "true", "check_call", "lower", "str", "and", "call", "code", "names", "not", "split", "_banned_from", "_banned_mods", "_is_attr_name", "check_net_system_safety"], "text_preview": "if a1.lower() == \"/c\" and a2.lower() == \"start\":\n            return True\n    return False\n\n\ndef check_net_system_safety(code: str) -> Optional[str]:\n    if not is_enabled(\"net_system_safety\", True):\n        return None\n    t = get_ast(code)\n    if not t:\n ", "line_start": 75, "line_end": 101}, {"sha": "3ab54e4d86d0a4ab51d222422036d3a48d29bb0cd26a8bd8900f887c6f16cd5b", "index": 3, "path": "a6182b0b__jinx__codeexec__validators__net_safety.py\\3ab54e4d86d0a4ab51d222422036d3a48d29bb0cd26a8bd8900f887c6f16cd5b.json", "terms": ["and", "value", "ast", "isinstance", "attribute", "return", "none", "disallowed", "_banned_funcs", "getattr", "attr", "bans", "call", "continue", "func", "name", "shell", "subprocess", "true", "_is_safe_open_popen", "_is_safe_pip_install_call", "allow", "applying", "arg", "before"], "text_preview": "if isinstance(fn, ast.Attribute) and isinstance(fn.value, ast.Name) and fn.value.id == \"subprocess\":\n                for kw in (n.keywords or []):\n                    if (kw.arg or \"\") == \"shell\" and isinstance(getattr(kw, \"value\", None), ast.Constant) and", "line_start": 102, "line_end": 116}], "file_terms": ["ast", "return", "and", "isinstance", "seq", "call", "node", "value", "name", "subprocess", "not", "none", "false", "import", "_const_str", "str", "true", "arg0", "attribute", "def", "disallowed", "from", "args", "for", "func"]}