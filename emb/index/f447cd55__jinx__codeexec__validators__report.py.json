{"file_rel": "jinx\\codeexec\\validators\\report.py", "file_sha256": "c368e2c60b84395b6857d90a538218c273db5f9e85a661ba41c7896b62b447ed", "updated_ts": 1760763310.0927758, "total_chunks": 11, "chunks": [{"sha": "4786777970605cdef31dfd225aa51c52b77722d9048632472a71d03e75a09eb1", "index": 0, "path": "f447cd55__jinx__codeexec__validators__report.py\\4786777970605cdef31dfd225aa51c52b77722d9048632472a71d03e75a09eb1.json", "terms": ["import", "subprocess", "ast", "node", "from", "return", "src", "popen", "def", "float", "optional", "tok", "tokenize", "_tokenize", "check_call", "check_output", "isinstance", "call", "int", "list", "str", "string", "system", "value", "__future__"], "text_preview": "from __future__ import annotations\n\nfrom typing import Any, Dict, List, Optional\nimport ast\nimport io\nimport tokenize\n\nfrom .ast_cache import get_ast\n\n# Reuse policy details from sibling validators without importing them to avoid cycles\n_BANNED_DYN = {\"eva", "line_start": 1, "line_end": 38}, {"sha": "50aae93a13417ea1cf27e3714868e22909645c95ecb67fb7e68e56465b947926", "index": 1, "path": "f447cd55__jinx__codeexec__validators__report.py\\50aae93a13417ea1cf27e3714868e22909645c95ecb67fb7e68e56465b947926.json", "terms": ["return", "ast", "src", "error", "str", "tree", "and", "code", "def", "list", "none", "syntax", "node_iter", "msg", "any", "dict", "hints", "int", "line", "not", "out", "parse", "pred", "_first", "_iter_ast"], "text_preview": "while i < len(s) and s[i] in \"rRuUfFbB\":\n                i += 1\n            if s[i : i + 3] in (\"'''\", '\"\"\"'):\n                return int(tok.start[0])\n    # fallback textual\n    if \"'''\" in src or '\"\"\"' in src:\n        return 1\n    return None\n\n\ndef _firs", "line_start": 39, "line_end": 80}, {"sha": "21ebbb72f9d2ba5a80fc55f14749ca650c0d029bf6cae30cd5812c6a856c7d55", "index": 2, "path": "f447cd55__jinx__codeexec__validators__report.py\\21ebbb72f9d2ba5a80fc55f14749ca650c0d029bf6cae30cd5812c6a856c7d55.json", "terms": ["func", "none", "getattr", "ast", "isinstance", "not", "and", "tq_line", "dyn", "try", "_first", "_iter_ast", "value", "allowed", "append", "category", "except", "lambda", "line", "msg", "name", "out", "policy", "prompt", "quotes"], "text_preview": "t = get_ast(src)\n\n    # try/except\n    tr = _first(_iter_ast(t), lambda n: isinstance(n, ast.Try))\n    if tr is not None:\n        out.append({\n            \"id\": \"try_except\",\n            \"category\": \"policy\",\n            \"msg\": \"Usage of try/except/finally", "line_start": 81, "line_end": 110}, {"sha": "f4d74a12ba1893cbafc128b00e3dc9285c50ab4145b0b1ab47fe823d71597b53", "index": 3, "path": "f447cd55__jinx__codeexec__validators__report.py\\f4d74a12ba1893cbafc128b00e3dc9285c50ab4145b0b1ab47fe823d71597b53.json", "terms": ["getattr", "name", "safety", "append", "ast", "category", "for", "isinstance", "out", "none", "call", "disallowed", "dynamic", "import", "int", "line", "lineno", "mod", "msg", "names", "split", "_banned_net_from", "_banned_net_mods", "_iter_ast", "net_from"], "text_preview": "name = getattr(fn, 'id', None) or (f\"{getattr(getattr(fn,'value', None),'id', '?')}.{getattr(fn,'attr','?')}\" if isinstance(fn, ast.Attribute) else 'call')\n        out.append({\n            \"id\": \"dynamic\",\n            \"category\": \"safety\",\n            \"msg", "line_start": 111, "line_end": 137}, {"sha": "a1a6a1a8241eb6d7ca933ac571234accc3d5d053eb22b714c2dac514c4809c0c", "index": 4, "path": "f447cd55__jinx__codeexec__validators__report.py\\a1a6a1a8241eb6d7ca933ac571234accc3d5d053eb22b714c2dac514c4809c0c.json", "terms": ["ast", "getattr", "isinstance", "call", "and", "disallowed", "int", "line", "lineno", "msg", "name", "_banned_net_funcs", "net_call", "append", "attr", "category", "func", "none", "out", "safety", "_iter_ast", "attribute", "break", "deletes", "filesystem"], "text_preview": "\"msg\": f\"from {mod} import {a.name} is disallowed\",\n                        \"line\": int(getattr(n, 'lineno', 1) or 1),\n                    })\n                    break\n        if isinstance(n, ast.Call):\n            fn = getattr(n, 'func', None)\n          ", "line_start": 138, "line_end": 163}, {"sha": "84987998e269568067df6eabccb95e01800f0b0020d77bba61ec5e5c22edecc2", "index": 5, "path": "f447cd55__jinx__codeexec__validators__report.py\\84987998e269568067df6eabccb95e01800f0b0020d77bba61ec5e5c22edecc2.json", "terms": ["isinstance", "args", "and", "getattr", "ast", "fs_write", "func", "append", "category", "direct", "disallowed", "file", "for", "input", "int", "jinx", "line", "lineno", "micro", "msg", "out", "patcher", "runtime", "safety", "use"], "text_preview": "if len(n.args) >= 2 and isinstance(n.args[1], ast.Constant) and isinstance(n.args[1].value, str):\n                    m = n.args[1].value\n                    if any(ch in m for ch in ('w','a','x','+')):\n                        out.append({\n                ", "line_start": 164, "line_end": 184}, {"sha": "02cfc23e8644bc029a1ae8e524afd0f7c4821a5058e5556d28bfea995720cf1d", "index": 6, "path": "f447cd55__jinx__codeexec__validators__report.py\\02cfc23e8644bc029a1ae8e524afd0f7c4821a5058e5556d28bfea995720cf1d.json", "terms": ["and", "ast", "isinstance", "func", "getattr", "none", "value", "attr", "attribute", "_max_sleep_seconds", "append", "args", "category", "for", "int", "line", "lineno", "msg", "not", "out", "readline", "sleep", "_const_num", "_iter_ast", "blocking_io"], "text_preview": "or (isinstance(getattr(c,'func', None), ast.Attribute) and c.func.attr == 'readline' and isinstance(getattr(c.func, 'value', None), ast.Attribute) and c.func.value.attr == 'stdin')\n    )\n    if bl is not None:\n        out.append({\n            \"id\": \"blocki", "line_start": 185, "line_end": 209}, {"sha": "665272ea5586e7919058c5c5e38c4a33c09184e339a664901da500be913fedda", "index": 7, "path": "f447cd55__jinx__codeexec__validators__report.py\\665272ea5586e7919058c5c5e38c4a33c09184e339a664901da500be913fedda.json", "terms": ["ast", "bound", "isinstance", "args", "and", "break", "_const_num", "_max_range_const", "has_break", "func", "test", "append", "category", "int", "msg", "not", "out", "range", "true", "while", "range_large", "while_true", "any", "call", "constant"], "text_preview": "it = n.iter\n            if isinstance(it, ast.Call) and isinstance(it.func, ast.Name) and it.func.id == 'range':\n                if it.args:\n                    bound = _const_num(it.args[0]) if len(it.args) == 1 else _const_num(it.args[-1])\n              ", "line_start": 210, "line_end": 229}, {"sha": "a18eda18d2df997862300dd4a96ba74b94ccc12b024d67d1e84a8e467a1d94d0", "index": 8, "path": "f447cd55__jinx__codeexec__validators__report.py\\a18eda18d2df997862300dd4a96ba74b94ccc12b024d67d1e84a8e467a1d94d0.json", "terms": ["ast", "getattr", "int", "lineno", "elts", "keys", "isinstance", "line", "_max_list_literal_elems", "end_lineno", "append", "category", "for", "large", "len", "msg", "out", "too", "_iter_ast", "_max_loop_body_lines", "literal_huge", "loop_huge", "approximate", "asyncfor", "bodies"], "text_preview": "\"line\": int(getattr(n, 'lineno', 1) or 1),\n                    })\n\n    # IO clamps (oversized bodies / huge literals)\n    for n in _iter_ast(t):\n        if isinstance(n, (ast.For, ast.AsyncFor, ast.While)):\n            # approximate span: end_lineno - line", "line_start": 230, "line_end": 257}, {"sha": "50b8fec3ddc49c380ba57d196a424c3dbdd0df881ae0f974e93b569ae3c9a0a1", "index": 9, "path": "f447cd55__jinx__codeexec__validators__report.py\\50b8fec3ddc49c380ba57d196a424c3dbdd0df881ae0f974e93b569ae3c9a0a1.json", "terms": ["func", "and", "getattr", "ast", "isinstance", "none", "value", "attr", "attribute", "not", "src", "name", "open", "intends_open", "sentinel", "_iter_ast", "dict_huge", "jinx_error", "any", "append", "call", "category", "code", "dict", "effects"], "text_preview": "out.append({\n                    \"id\": \"dict_huge\",\n                    \"category\": \"rt\",\n                    \"msg\": \"dict literal too large\",\n                    \"line\": int(getattr(n, 'lineno', 1) or 1),\n                })\n\n    # Side-effects sentinel po", "line_start": 258, "line_end": 274}, {"sha": "2c0274753e4aa670f2f2e9f1fa8060b2d0e43d0d51d4e1a8883b4fe16a8b821a", "index": 10, "path": "f447cd55__jinx__codeexec__validators__report.py\\2c0274753e4aa670f2f2e9f1fa8060b2d0e43d0d51d4e1a8883b4fe16a8b821a.json", "terms": ["out", "side_effects", "append", "category", "effect", "error", "line", "msg", "must", "policy", "prints", "return", "sentinel", "side", "verify", "with"], "text_preview": "out.append({\n            \"id\": \"side_effects\",\n            \"category\": \"policy\",\n            \"msg\": \"side-effect must verify with sentinel prints (OK:/ERROR:)\",\n            \"line\": 1,\n        })\n\n    return out", "line_start": 275, "line_end": 282}], "file_terms": ["ast", "getattr", "isinstance", "and", "func", "none", "int", "out", "msg", "line", "value", "append", "category", "lineno", "name", "for", "not", "src", "call", "attr", "return", "attribute", "args", "_iter_ast", "disallowed"]}