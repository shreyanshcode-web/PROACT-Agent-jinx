{"file_rel": "jinx\\micro\\embeddings\\project_snippet.py", "file_sha256": "5ff79635691c75cd36a8060b2ca3c9aa46989f336fffdd9919abc2a4f846ebac", "updated_ts": 1760763311.3129869, "total_chunks": 10, "chunks": [{"sha": "e079af1fe639e1d22088fbfade77fb3f1676f240c6fd8cd53f95bf2054a58df4", "index": 0, "path": "2603f3f3__jinx__micro__embeddings__project_snippet.py\\e079af1fe639e1d22088fbfade77fb3f1676f240c6fd8cd53f95bf2054a58df4.json", "terms": ["import", "from", "__future__", "build_multi_segment_python", "coalesce_enter", "coalesce_exit", "coalesce_wait_ms", "codeish_tokens", "expand_strong_tokens", "extract_callees_from_scope", "extract_code_core", "extract_identifiers", "file_signature", "find_def_scope_in_project", "find_line_window", "find_python_scope", "get_cached_snippet", "get_python_symbol_at_line", "lang_for_file", "make_snippet_cache_key", "proj_expand_callee_max_chars", "proj_expand_callees_top_n", "proj_multi_segment_enable", "proj_scope_max_chars", "proj_segment_head_lines"], "text_preview": "from __future__ import annotations\n\nimport os\nfrom typing import Any, Dict, List, Tuple\nimport re\n\nfrom .project_config import ROOT\nfrom .project_retrieval_config import (\n    PROJ_SNIPPET_AROUND,\n    PROJ_SNIPPET_PER_HIT_CHARS,\n    PROJ_SCOPE_MAX_CHARS,\n ", "line_start": 1, "line_end": 39}, {"sha": "d7c58cb03a2886f58c342b5c13db62eb7ae3f5d93ce38a83a03cc8d3b2a7991b", "index": 1, "path": "2603f3f3__jinx__micro__embeddings__project_snippet.py\\d7c58cb03a2886f58c342b5c13db62eb7ae3f5d93ce38a83a03cc8d3b2a7991b.json", "terms": ["str", "int", "meta", "none", "prefer_full_scope", "_sig0", "file_rel", "header", "bool", "get", "abs_path", "is_full_scope", "rel_path", "def", "except", "exception", "false", "query", "return", "snippet", "true", "try", "_cache_key", "_read_file", "build_snippet"], "text_preview": "def _read_file(rel_path: str) -> str:\n    try:\n        abs_path = os.path.join(ROOT, rel_path)\n        with open(abs_path, 'r', encoding='utf-8', errors='ignore') as f:\n            return f.read()\n    except Exception:\n        return \"\"\n\n\ndef build_snippet", "line_start": 40, "line_end": 81}, {"sha": "29cd0295a9ee83c101e06bf007e2947824edb5d0c80df3bbf655b0a6f8658118", "index": 2, "path": "2603f3f3__jinx__micro__embeddings__project_snippet.py\\29cd0295a9ee83c101e06bf007e2947824edb5d0c80df3bbf655b0a6f8658118.json", "terms": ["_wait_ev", "none", "_cached", "_cached2", "_leader", "except", "exception", "try", "file_rel", "_cache_key", "file_text", "expand_callees", "extra_centers_abs", "get_cached_snippet", "not", "and", "false", "mode", "return", "the", "_read_file", "_sig0", "coalesce_enter", "coalesce_wait_ms", "file_sig"], "text_preview": "expand_callees=expand_callees,\n        extra_centers_abs=extra_centers_abs,\n        file_sig=_sig0,\n    )\n    try:\n        _cached = get_cached_snippet(_cache_key)\n    except Exception:\n        _cached = None\n    if _cached:\n        return _cached\n\n    # C", "line_start": 82, "line_end": 122}, {"sha": "931359fcb4c707105511cefd05c64d7b422f2d81589102d2478e8ea604d8bba0", "index": 3, "path": "2603f3f3__jinx__micro__embeddings__project_snippet.py\\931359fcb4c707105511cefd05c64d7b422f2d81589102d2478e8ea604d8bba0.json", "terms": ["lines_all", "file_text", "esc", "core", "len", "a_i", "b_i", "span", "and", "body", "count", "else", "escape", "max", "min", "pat", "pre", "start", "extract_code_core", "is_full_scope", "local_le", "local_ls", "build", "code", "compile"], "text_preview": "if (ls == 1 and le == len(lines_all)):\n            body = file_text\n            local_ls, local_le = 1, len(lines_all)\n            is_full_scope = True\n        elif ls or le:\n            a = max(1, ls)\n            b = le if le > 0 else a\n            a_i = ", "line_start": 123, "line_end": 151}, {"sha": "02f9f0f7b420e4d5ba37a5d58e9e568c279881b41f14035ded80a958be4affaa", "index": 4, "path": "2603f3f3__jinx__micro__embeddings__project_snippet.py\\02f9f0f7b420e4d5ba37a5d58e9e568c279881b41f14035ded80a958be4affaa.json", "terms": ["use_le", "use_ls", "and", "lines_all", "file_text", "local_le", "local_ls", "proj_snippet_around", "len", "snip", "cand_line", "e_scope", "q_toks", "s_scope", "body", "int", "not", "query", "extract_identifiers", "file_rel", "find_line_window", "find_python_scope", "max_items", "around", "budget"], "text_preview": "lines_all = file_text.splitlines()\n                        a = max(1, ls - PROJ_SNIPPET_AROUND)\n                        b = min(len(lines_all), le + PROJ_SNIPPET_AROUND)\n                        snip = \"\\n\".join(lines_all[a-1:b]).strip()\n                exc", "line_start": 152, "line_end": 173}, {"sha": "1b47820a40d4f6be040a9ce01e05429a3705dd7736054c1b379485274c5616e1", "index": 5, "path": "2603f3f3__jinx__micro__embeddings__project_snippet.py\\1b47820a40d4f6be040a9ce01e05429a3705dd7736054c1b379485274c5616e1.json", "terms": ["scope_text", "lines_all", "len", "proj_scope_max_chars", "e_idx", "e_scope", "proj_snippet_per_hit_chars", "s_idx", "s_scope", "too_large_scope", "and", "build_multi_segment_python", "head_lines", "mid_windows", "per_hit_chars", "prefer_full_scope", "proj_multi_segment_enable", "proj_segment_head_lines", "proj_segment_mid_windows", "proj_segment_tail_lines", "tail_lines", "body", "class", "composite", "entire"], "text_preview": "s_idx = max(1, s_scope) - 1\n                    e_idx = min(len(lines_all), e_scope) - 1\n                    scope_text = \"\\n\".join(lines_all[s_idx:e_idx+1]).strip()\n                    if scope_text:\n                        if prefer_full_scope:\n         ", "line_start": 174, "line_end": 190}, {"sha": "1eb278678657d977cbfa016855861c6496f9a44d381d14c8aaefa3201c275ee1", "index": 6, "path": "2603f3f3__jinx__micro__embeddings__project_snippet.py\\1eb278678657d977cbfa016855861c6496f9a44d381d14c8aaefa3201c275ee1.json", "terms": ["scope_text", "is_full_scope", "proj_scope_max_chars", "body", "true", "e_scope", "local_le", "local_ls", "s_scope", "elif", "else", "false", "len", "cand_line", "did_segment", "extra_centers", "extra_centers_abs", "mid_around", "proj_segment_mid_around", "proj_segment_strip_comments", "proj_snippet_per_hit_chars", "strip_comments", "and", "around", "candidate"], "text_preview": "mid_around=PROJ_SEGMENT_MID_AROUND,\n                                    strip_comments=PROJ_SEGMENT_STRIP_COMMENTS,\n                                    extra_centers=extra_centers_abs,\n                                )\n                                did_s", "line_start": 191, "line_end": 210}, {"sha": "ecde8551af78d6d187db5530ca8332ebeb9a4716b83e3ced0f65340240c7592c", "index": 7, "path": "2603f3f3__jinx__micro__embeddings__project_snippet.py\\ecde8551af78d6d187db5530ca8332ebeb9a4716b83e3ced0f65340240c7592c.json", "terms": ["local_le", "local_ls", "body", "file_rel", "and", "header", "sym_name", "cand_line", "file_text", "lines_all", "proj_snippet_around", "proj_snippet_per_hit_chars", "sym_kind", "int", "not", "else", "final", "len", "python", "symbol", "with", "did_segment", "get_python_symbol_at_line", "is_full_scope", "available"], "text_preview": "a = max(1, c - PROJ_SNIPPET_AROUND)\n                            b = min(len(lines_all), c + PROJ_SNIPPET_AROUND)\n                            body = \"\\n\".join(lines_all[a-1:b]).strip() or body\n                            local_ls, local_le = a, b\n          ", "line_start": 211, "line_end": 234}, {"sha": "dec4bee60346c8f54ad38708d33f0c3f5f461464d3ed7475a6816eb92eca3302", "index": 8, "path": "2603f3f3__jinx__micro__embeddings__project_snippet.py\\dec4bee60346c8f54ad38708d33f0c3f5f461464d3ed7475a6816eb92eca3302.json", "terms": ["file_rel", "lines_all", "proj_expand_callees_top_n", "and", "callees", "defs", "_cf", "abs_p", "e_i", "s_i", "body", "for", "join", "not", "seg", "src", "try", "used", "did_segment", "expand_callees", "extract_callees_from_scope", "final_body", "find_def_scope_in_project", "is_full_scope", "lang_for_file"], "text_preview": "except Exception:\n        pass\n\n    # Optional: expand a couple of direct callees for Python full-scope snippets\n    lang = lang_for_file(file_rel)\n    final_body = body\n    try:\n        if expand_callees and file_rel.endswith('.py') and PROJ_EXPAND_CALLEE", "line_start": 235, "line_end": 261}, {"sha": "3f3bc0b440ad3003dc33f8515945f108f8b365cdb037499758a32cdd1a415d83", "index": 9, "path": "2603f3f3__jinx__micro__embeddings__project_snippet.py\\3f3bc0b440ad3003dc33f8515945f108f8b365cdb037499758a32cdd1a415d83.json", "terms": ["seg", "except", "exception", "final_body", "proj_expand_callee_max_chars", "_result", "appended", "pass", "_sig0", "_cache_key", "_sig1", "code_block", "header_line", "int", "lang", "and", "continue", "try", "_leader", "coalesce_exit", "file_rel", "file_signature", "is_full_scope", "local_le", "local_ls"], "text_preview": "continue\n                    if PROJ_EXPAND_CALLEE_MAX_CHARS > 0 and len(seg) > PROJ_EXPAND_CALLEE_MAX_CHARS:\n                        seg = seg[:PROJ_EXPAND_CALLEE_MAX_CHARS]\n                    header_line = f\"# callee: {nm} [{fr}:{s}-{e}]\"\n              ", "line_start": 262, "line_end": 289}], "file_terms": ["and", "lines_all", "body", "local_le", "local_ls", "file_rel", "len", "import", "from", "file_text", "except", "exception", "try", "int", "is_full_scope", "none", "scope_text", "not", "header", "else", "str", "join", "max", "pass", "true"]}