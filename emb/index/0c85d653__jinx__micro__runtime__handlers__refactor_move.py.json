{"file_rel": "jinx\\micro\\runtime\\handlers\\refactor_move.py", "file_sha256": "c8d04746df98ae156921b586be5deed46b234fe7700247ad0ac801bd9bdb1d62", "updated_ts": 1760763313.1914551, "total_chunks": 5, "chunks": [{"sha": "52787b124cc0780168d7581794a8602db3955abc83b6079b246cecee880a2dc1", "index": 0, "path": "0c85d653__jinx__micro__runtime__handlers__refactor_move.py\\52787b124cc0780168d7581794a8602db3955abc83b6079b246cecee880a2dc1.json", "terms": ["str", "import", "from", "list", "_abs_path", "dst_path", "dict", "ops", "jinx", "micro", "runtime", "src_path", "meta", "none", "and", "awaitable", "batch", "bool", "callable", "symbol", "tuple", "__future__", "__init__", "_build_move_plan", "_ensure_newline"], "text_preview": "from __future__ import annotations\n\nimport os\nfrom typing import Callable, Awaitable, List, Dict, Optional, Tuple\n\nfrom jinx.micro.runtime.api import report_progress, report_result\nfrom jinx.micro.runtime.handlers.batch_handler import handle_batch_patch as", "line_start": 1, "line_end": 37}, {"sha": "5d2fe6e7454bcfdaabd8a14a54081b91a462128607cb0517c4224d93c585e64e", "index": 1, "path": "0c85d653__jinx__micro__runtime__handlers__refactor_move.py\\5d2fe6e7454bcfdaabd8a14a54081b91a462128607cb0517c4224d93c585e64e.json", "terms": ["src_lines", "dst_new", "meta", "ap_dst", "dst_text", "import", "true", "await", "code", "get", "not", "symbol", "_read", "ap_src", "dst_mod", "src_text", "and", "binding", "content", "destination", "else", "endswith", "int", "len", "max"], "text_preview": "ok, code, meta = await extract_symbol_source(ap_src, symbol, include_decorators=True, include_docstring=True)\n    if not ok:\n        raise RuntimeError(f\"extract failed: {meta.get('error')}\")\n    src_text = await _read(ap_src)\n    try:\n        dst_text = a", "line_start": 38, "line_end": 69}, {"sha": "3a8358f92818544d7c3e48f588d6ae34541e5ebf74b8b9ec460aa2c05309a969", "index": 2, "path": "0c85d653__jinx__micro__runtime__handlers__refactor_move.py\\3a8358f92818544d7c3e48f588d6ae34541e5ebf74b8b9ec460aa2c05309a969.json", "terms": ["symbol", "path", "kept", "init_text", "idx", "write", "ap_dst", "file", "join", "ops", "__init__", "dst_dir", "import_line", "init_path", "rel_mod", "src_new", "append", "code", "destination", "from", "import", "meta", "move", "refactor", "role"], "text_preview": "import_line = f\"from {dst_mod} import {symbol}\"\n        idx = _import_insertion_index(\"\\n\".join(kept))\n        # insert after idx\n        kept = kept[:idx] + [import_line] + kept[idx:]\n\n    src_new = _ensure_newline(\"\\n\".join(kept))\n\n    ops: List[Dict[str", "line_start": 70, "line_end": 96}, {"sha": "59ecf5ce278ff63c0da21834874651fbf9d1798bf5faa5caa5dd55caedcd8523", "index": 3, "path": "0c85d653__jinx__micro__runtime__handlers__refactor_move.py\\59ecf5ce278ff63c0da21834874651fbf9d1798bf5faa5caa5dd55caedcd8523.json", "terms": ["lines", "str", "symbol", "none", "optional", "_module_name_from_path", "append", "bool", "ops", "_truthy", "ap_dst", "export_line", "init_new", "more_ops", "new_mod", "old_mod", "grouped", "strip", "_ensure_newline", "ap_src", "create_init", "dst_init", "dst_module", "dst_path", "grouped_enabled"], "text_preview": "if not any(ln.strip() == export_line for ln in lines):\n            if lines and lines[-1].strip():\n                lines.append(\"\")\n            lines.append(export_line)\n        init_new = _ensure_newline(\"\\n\".join(lines))\n        ops.append({\"type\": \"writ", "line_start": 97, "line_end": 126}, {"sha": "2a96bc2afe3a40f25d61accf8b5f0511131569553ea8d561e1cf4dd0fb125622", "index": 4, "path": "0c85d653__jinx__micro__runtime__handlers__refactor_move.py\\2a96bc2afe3a40f25d61accf8b5f0511131569553ea8d561e1cf4dd0fb125622.json", "terms": ["symbol", "await", "create_init", "insert_shim", "_truthy", "exports", "force", "batch", "else", "none", "not", "tid", "verify_cb", "dst_path", "report_progress", "src_path", "from", "and", "handler", "move", "ops", "package", "preview", "top", "with"], "text_preview": "\"\"\"Move a top-level function/class to another module with safe shims and package exports.\n\n    - Writes symbol code to dst_path (appending, creates file if needed)\n    - Removes symbol from src_path and inserts `from <dst_module> import <symbol>` at the to", "line_start": 127, "line_end": 143}], "file_terms": ["symbol", "str", "import", "from", "ops", "await", "ap_dst", "meta", "none", "dst_new", "path", "not", "src_lines", "lines", "and", "code", "move", "create_init", "insert_shim", "_truthy", "dst_path", "kept", "append", "bool", "destination"]}